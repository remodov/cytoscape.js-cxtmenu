<!DOCTYPE>

<html>

	<head>
		<title>cytoscape-cxtmenu.js demo</title>

		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">

		<link href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
		<link href="https://cdnjs.cloudflare.com/ajax/libs/cytoscape-panzoom/2.5.3/cytoscape.js-panzoom.min.css" rel="stylesheet" type="text/css" />

		<script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>


		<script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.js"></script>



		<script src="https://unpkg.com/webcola/WebCola/cola.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/cytoscape-cola@2.2.4/cytoscape-cola.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/cytoscape-cxtmenu@3.0.2/cytoscape-cxtmenu.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape-panzoom/2.5.3/cytoscape-panzoom.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/cytoscape-qtip@2.7.1/cytoscape-qtip.min.js"></script>



		<style>
			body {
				font-family: helvetica;
				font-size: 14px;
				overflow: hidden;
			}

			#cy {
				width: 100%;
				height: 100%;
				position: absolute;
				left: 0;
				top: 0;
				z-index: 999;
			}

			h1 {
				opacity: 0.5;
				font-size: 1em;
			}

			/* you can set the disabled style how you like on the text/icon */
			.cxtmenu-disabled {
				opacity: 0.333;
			}
		</style>

		<script>

			window.addEventListener('DOMContentLoaded', function(){

			    var elementsGenerated = {nodes : [], edges: []};

                for (let i = 0; i < 400 ; i++) {
                    elementsGenerated.nodes.push({ data: { id: 'j-'+i, name: 'Jerry' + i }});
                }

                for (let i = 1; i < 390 ; i++) {
                    elementsGenerated.edges.push({data: {source: 'j-'+i, target: 'j-'+(i-1)}});
                    elementsGenerated.edges.push({data: {source: 'j-'+i, target: 'j-'+(i+1)}});
                  //  elementsGenerated.edges.push({data: {source: 'j-'+i, target: 'j-'+(i+2)}});

                    if ((i % 2) === 0){
                   //     elementsGenerated.edges.push({data: {source: 'j-1', target: 'j-'+i}});
					}
                }



				var cy = window.cy = cytoscape({
					container: document.getElementById('cy'),

                    layout: {
                        name: 'cola'
                    },

					ready: function(){
					},

					style: [
						{
							selector: 'node',
							css: {
								'content': 'data(name)'
							},
                            style: {
                                'background-color': 'rgb(153, 51, 0)',
                                'border-width': 2,
                                'border-color': 'black',
                                'label': 'data(id)'
                            }
						},

						{
							selector: 'edge',
							css: {
								'curve-style': 'bezier',
								'target-arrow-shape': 'triangle'
							},
                            style: {
                                'width': 1,
                                'line-color': 'rgb(153, 204, 0)',
                                'target-arrow-color': '#ccc',
                                'target-arrow-shape': 'triangle'
                            }

						}
					],

					elements: elementsGenerated
				});




                var defaults = {
                    animate: true, // whether to show the layout as it's running
                    refresh: 1, // number of ticks per frame; higher is faster but more jerky
                    maxSimulationTime: 4000, // max length in ms to run the layout
                    ungrabifyWhileSimulating: false, // so you can't drag nodes during layout
                    fit: true, // on every layout reposition of nodes, fit the viewport
                    padding: 30, // padding around the simulation
                    boundingBox: undefined, // constrain layout bounds; { x1, y1, x2, y2 } or { x1, y1, w, h }
                    nodeDimensionsIncludeLabels: false, // whether labels should be included in determining the space used by a node

                    // layout event callbacks
                    ready: function(){}, // on layoutready
                    stop: function(){}, // on layoutstop

                    // positioning options
                    randomize: false, // use random node positions at beginning of layout
                    avoidOverlap: true, // if true, prevents overlap of node bounding boxes
                    handleDisconnected: true, // if true, avoids disconnected components from overlapping
                    nodeSpacing: function( node ){ return 10; }, // extra spacing around nodes
                    flow: undefined, // use DAG/tree flow layout if specified, e.g. { axis: 'y', minSeparation: 30 }
                    alignment: undefined, // relative alignment constraints on nodes, e.g. function( node ){ return { x: 0, y: 1 } }
                    gapInequalities: undefined, // list of inequality constraints for the gap between the nodes, e.g. [{"axis":"y", "left":node1, "right":node2, "gap":25}]. The constraint in the example says that the center of node1 must be at least 25 pixels above the center of node2. In other words, it is an inequality constraint that requires "node1.y + gap <= node2.y". You can set the extra "equality" attribute as "true" to convert it into an equality constraint.

                    // different methods of specifying edge length
                    // each can be a constant numerical value or a function like `function( edge ){ return 2; }`
                    edgeLength: undefined, // sets edge length directly in simulation
                    edgeSymDiffLength: undefined, // symmetric diff edge length in simulation
                    edgeJaccardLength: undefined, // jaccard edge length in simulation

                    // iterations of cola algorithm; uses default values on undefined
                    unconstrIter: undefined, // unconstrained initial layout iterations
                    userConstIter: undefined, // initial layout iterations with user-specified constraints
                    allConstIter: undefined, // initial layout iterations with all constraints including non-overlap

                    // infinite layout options
                    infinite: false // overrides all other options for a forces-all-the-time mode
                };

               // cy.layout({ name: 'random', defaults }).run();

               /* cy.on('mouseover', 'node', function(event) {
                    var node = event.cyTarget;
                    node.qtip({
                        content: 'hello',
                        show: {
                            event: event.type,
                            ready: true
                        },
                        hide: {
                            event: 'mouseout unfocus'
                        }
                    }, event);
                });*/

				cy.cxtmenu({
					selector: 'node, edge',

					commands: [
						{
							content: '<span class="fa fa-flash fa-2x"></span>',
							select: function(ele){
								console.log( ele.id() );
							}
						},

						{
							content: '<span class="fa fa-star fa-2x"></span>',
							select: function(ele){
								console.log( ele.data('name') );
							},
							enabled: false
						},

						{
							content: 'Text',
							select: function(ele){
								console.log( ele.position() );
							}
						}
					]
				});

				cy.cxtmenu({
					selector: 'core',

					commands: [
						{
							content: 'bg1',
							select: function(){
								console.log( 'bg1' );
							}
						},

						{
							content: 'bg2',
							select: function(){
								console.log( 'bg2' );
							}
						}
					]
				});

                var defaultsZoom = {
                    zoomFactor: 0.05, // zoom factor per zoom tick
                    zoomDelay: 45, // how many ms between zoom ticks
                    minZoom: 0.1, // min zoom level
                    maxZoom: 10, // max zoom level
                    fitPadding: 50, // padding when fitting
                    panSpeed: 10, // how many ms in between pan ticks
                    panDistance: 10, // max pan distance per tick
                    panDragAreaSize: 75, // the length of the pan drag box in which the vector for panning is calculated (bigger = finer control of pan speed and direction)
                    panMinPercentSpeed: 0.25, // the slowest speed we can pan by (as a percent of panSpeed)
                    panInactiveArea: 8, // radius of inactive area in pan drag box
                    panIndicatorMinOpacity: 0.5, // min opacity of pan indicator (the draggable nib); scales from this to 1.0
                    zoomOnly: false, // a minimal version of the ui only with zooming (useful on systems with bad mousewheel resolution)
                    fitSelector: undefined, // selector of elements to fit
                    animateOnFit: function(){ // whether to animate on fit
                        return false;
                    },
                    fitAnimationDuration: 1000, // duration of animation on fit

                    // icon class names
                    sliderHandleIcon: 'fa fa-minus',
                    zoomInIcon: 'fa fa-plus',
                    zoomOutIcon: 'fa fa-minus',
                    resetIcon: 'fa fa-expand'
                };

                cy.panzoom( defaultsZoom );

                cy.elements().qtip({
                    content: function(){ return 'Example qTip on ele ' + this.id() },
                    position: {
                        my: 'top center',
                        at: 'bottom center'
                    },
                    style: {
                        classes: 'qtip-bootstrap',
                        tip: {
                            width: 16,
                            height: 8
                        }
                    }
                });
                // call on core
                cy.qtip({
                    content: 'Example qTip on core bg',
                    position: {
                        my: 'top center',
                        at: 'bottom center'
                    },
                    show: {
                        cyBgOnly: true
                    },
                    style: {
                        classes: 'qtip-bootstrap',
                        tip: {
                            width: 16,
                            height: 8
                        }
                    }
                });


			});
		</script>
	</head>

	<body>

		<div id="cy"></div>

	</body>

</html>
